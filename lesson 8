SELECT  
	profiles.gender AS gender,
	COUNT(*) AS total
	FROM profiles
	JOIN likes 
	ON profiles.user_id = likes.user_id
	GROUP BY gender
    ORDER BY total DESC
    LIMIT 1;   

   SELECT 
   CONCAT(first_name, ' ', last_name) AS user,
   COUNT(messages.id) AS user_messages,
   COUNT(posts.id) AS user_posts,
   COUNT(media.id) AS user_media,
   COUNT(likes.id) AS user_likes
   FROM users 
   LEFT JOIN messages
   ON messages.from_user_id = users.id
   LEFT JOIN posts 
   ON posts.user_id = users.id
   LEFT JOIN media 
   ON media.user_id = users.id 
   LEFT JOIN likes 
   ON likes.user_id = users.id 
   GROUP BY user;
     
    
   

SELECT 
profiles.user_id,
profiles.birthday,
COUNT(likes.id) as like_counter 
FROM  profiles 
left JOIN  likes
ON profiles.user_id = likes.target_id AND likes.target_type = 'users'
	  GROUP BY profiles.user_id
	  ORDER BY profiles.birthday
	  desc limit 10;
