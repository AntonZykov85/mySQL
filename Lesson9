задача 1

START TRANSACTION;
 INSERT INTO sample.users SELECT * FROM shop.users WHERE id = 1;
 DELETE FROM shop.users WHERE id = 1;
COMMIT;

DESC products;
DESC catalogs;
SELECT * FROM products;
SELECT * FROM catalogs;
show tables;

задача 2

CREATE OR REPLACE VIEW products_catalogs AS 
SELECT 
	products.name AS products,
	catalogs.name AS catalogs
FROM
	shop.products
JOIN
	shop.catalogs
ON
	products.catalog_id = catalogs.id; 

задача 3

use vk;

DELIMITER //

CREATE FUNCTION hello ()
RETURNS TINYTEXT NO SQL
BEGIN 
	DECLARE hour INT;
	SET hour = HOUR(NOW());
	CASE
		WHEN hour BETWEEN 0 AND 5 THEN 
			RETURN "GOOD NIGHT";
		WHEN hour BETWEEN 6 AND 11 THEN 
			RETURN "GOOD MORNING";
		WHEN hour BETWEEN 12 AND 17 THEN 
			RETURN "GOOD DAY";
		WHEN hour BETWEEN 18 AND 23 THEN 
			RETURN "GOOD EVENING";
	END CASE;
END//

DELIMITER ;
SELECT NOW(), hello();

задача 4

use shop;
desc products;

DELIMITER //

CREATE TRIGGER validate_name_desc_on_insert BEFORE INSERT ON products
FOR EACH ROW BEGIN 
	IF NEW.name IS NULL AND NEW.description IS NULL THEN 
		SIGNAL SQLSTATE '45000'
		SET MESSAGE_TEXT = 'Both product name and product descriptiom are NULL' ;
	END IF;
END//

CREATE TRIGGER validate_name_desc_on_insert BEFORE UPDATE ON products
FOR EACH ROW BEGIN 
	IF NEW.name IS NULL AND NEW.description IS NULL THEN 
		SIGNAL SQLSTATE '45000'
		SET MESSAGE_TEXT = 'Both product name and product descriptiom are NULL';
	END IF;
END//
